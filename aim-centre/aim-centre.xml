<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
  <ModulePrefs title="ABVA Home Gadget" height="100">
  	<Require feature="dynamic-height"/> 
  </ModulePrefs>
  <UserPref name="siteDomain" display_name="Site Domain" datatype="string" required="true"/>
  <UserPref name="siteName" display_name="Site Name" datatype="string" required="true"/>
  <UserPref name="siteRoot" display_name="Site Root" datatype="string" required="true"/>
  
  <Content type="html">
     <![CDATA[
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
		
		<!--
 	    <meta http-Equiv="Cache-Control" Content="no-cache" />
	    <meta http-Equiv="Pragma" Content="no-cache" />
	    <meta http-Equiv="Expires" Content="-1" />
		-->

		<link rel="stylesheet" href="https://abvasvmc.github.io/css/bootstrap.min.css">
		<link rel="stylesheet" href="https://abvasvmc.github.io/abva2.css">
		
		<script src="https://abvasvmc.github.io/js/jquery.min.js"></script>
		<script src="https://abvasvmc.github.io/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="https://www.google.com/jsapi"></script>
		<script src="https://abvasvmc.github.io/abva2.js"></script>
    	<script src="https://abvasvmc.github.io/aim-centre/chroma.min.js" crossorigin="anonymous"></script> 

	   <style type="text/css">
	      .nav-tabs{
	        margin: 0 0 10px 0;
	        float: right;
	        border: none;
	      }
	      .nav-tabs li{
	        margin-left: 4px;
	      }
	      .nav-tabs li a.active {
	          /*display: none;*/
	          color: #888;
	          text-decoration: none;
	          cursor: default; 
	      }
	      .tab-pane{
	        clear: both;
	      }
	      .tab-pane{
	        text-align: justify;
	      }
	      .sinhala{
	        font-size: 0.85em;
	      }
	      .sinhala h2{
	        font-size: 1.8em;
	        margin-bottom: 15px;
	        padding-top: 8px;
	      }
	      .sidebar{
	        text-align: justify;
	        margin-top: 50px;
	      }
	      .sidebar-content{
	        margin: 0 10px 0 10px;
	      }
	      .sidebar-section-title{
	        font-size: 1.2em;
	        border-radius: 5px;
	        background-color: #abecff;
	        padding: 4px;
	      }
	      .sidebar h3{
	        font-size: 1.1em;
	        margin: 10px 10px 10px 0;
	        
	      }
	    </style>

		<div id="myCarousel" class="carousel slide carousel-fade" data-ride="carousel">
			<div class="d-none d-md-block">
			  <ol class="carousel-indicators">
			    <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
			    <li data-target="#myCarousel" data-slide-to="1"></li>
			    <li data-target="#myCarousel" data-slide-to="2"></li>
			  </ol>
			</div>

			<div class="carousel-inner">
			  <div class="carousel-item active">
			    <div class="img first-slide" style='background-image: url("https://abvasvmc.github.io/capital/banner_p1.jpg")'></div>
			    <div class="container" style="">
			    </div>
			  </div>
			  <div class="carousel-item">
			    <div class="img second-slide" style='background-image: url("https://abvasvmc.github.io/capital/banner_p2.jpg")'></div>
			    <div class="container">
			    </div>
			  </div>
			</div>
		</div>

		
		<script type="text/javascript">
		
			//Initialize feed loader
//			google.load("feeds", "1");
			var gadgetMode = true;
			

			var siteDomain = null;
			var siteName = null;
			var siteRoot = null;

			//Page initialization routine. This is called by google.setOnLoadCallback callback
			function initialize(feedUrlSeed) {
				
				//Getting user prefs
				var prefs = new gadgets.Prefs();
				siteDomain = prefs.getString("siteDomain");
				siteName = prefs.getString("siteName");
				siteRoot = prefs.getString("siteRoot");
				
				var apiKey = "AIzaSyCTisDVkthQZRXOcQH1mu17gOscxM0R-Y4";
				var newsCalendarId = "6aj48ba05tq87h990d2jr60i5g@group.calendar.google.com";
				var specialEventsCalendarId = "abva.org_mj5houtbi1u21ps8m5dc9chjsg@group.calendar.google.com";
				var announcementCalendarId = "abva.org_mbt7jtsna7nkbm542qr7924c94@group.calendar.google.com";
			
				//Signup sheet link
				$("#signup-sheet-link").attr("href", siteRoot + "/sign-up");

				//Loading carousel images
				var aspectRatio = 9.0/16;				
				
				//Loading Programs and News to the events display area
//				showCalendarEvents(announcementCalendarId, apiKey, "myEventsFeed", null, 200, 5, true);
//				showCalendarEvents(specialEventsCalendarId, apiKey, "myEventsFeed", null, 200, 20, true);
//				showCalendarEvents(newsCalendarId, apiKey, "myEventsFeed", null, 200, 5, true);

			} //End: function initialize()

			//Calling initialization routing on gadget loading
			gadgets.util.registerOnLoadHandler(function() { 
				initialize(Math.floor((Math.random() * 100000)));
				gadgets.window.adjustHeight();
				window.history.pushState({}, '', document.URL);
		   });
		   
		   //Resize-listener for gadget resizing on layout changes
		   var prevWindowWidth= -1;
		   var carousel_aspect_ratio = -1;
		   var prevSwitchedWidth = -1;
		   $( window ).resize(function() {
		        if(prevWindowWidth < 0){
		        	prevWindowWidth = $(window).width();
		        	prevSwitchedWidth = prevWindowWidth;
		        	carousel_aspect_ratio = $("#myCarousel").width() / $("#myCarousel").height()
		        }
		        else{
		        	var w = $(window).width();
		        	var resize_required = (prevWindowWidth >= 768 && w < 768) ||
		        						  (prevWindowWidth < 768 && w >= 768) ||
		        						  (prevWindowWidth >= 992 && w < 992) ||
		        						  (prevWindowWidth < 992 && w >= 992) | 
		        						  (prevWindowWidth <= w - 5) ||
		        						  (prevWindowWidth >= w+5);

		        	if(resize_required){
		        		gadgets.window.adjustHeight();
		        		prevSwitchedWidth = w;
		        	}
		        	
		        	if(carousel_aspect_ratio > 0){
		        		var new_carousel_height = $("#myCarousel").width() / carousel_aspect_ratio;
		        		$("#myCarousel").height(new_carousel_height)
		        	}
		        	
		        	//gadgets.window.adjustHeight();
		        	prevWindowWidth = w;					  
		        }
		    });	
						
		</script>
     ]]>
  </Content> 
</Module>