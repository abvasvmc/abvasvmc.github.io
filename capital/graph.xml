<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
  <ModulePrefs title="ABVA Home Gadget" height="100">
    <Require feature="dynamic-height"/> 
  </ModulePrefs>
  <UserPref name="siteDomain" display_name="Site Domain" datatype="string" required="true"/>
  <UserPref name="siteName" display_name="Site Name" datatype="string" required="true"/>
  <UserPref name="siteRoot" display_name="Site Root" datatype="string" required="true"/>
  
  <Content type="html">
     <![CDATA[
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
    
    <link rel="stylesheet" href="https://abvasvmc.github.io/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://abvasvmc.github.io/abva2.css">
    <link rel="stylesheet" href="https://abvasvmc.github.io/capital/graph.css">
    
    <script src="https://abvasvmc.github.io/js/jquery.min.js"></script>
    <script src="https://abvasvmc.github.io/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.2/Chart.min.js"></script>
    <script src="https://abvasvmc.github.io/abva2.js"></script>
    <script src="https://abvasvmc.github.io/capital/graph.js"></script>

  <div id="graphPanel" style="border: dashed 2px green">
    <div class="title">Confirmed Commitment Growth</div>
    <canvas></canvas>
    
    <div class="infoPanel container">
      <div class="row">
        <div class="infoLine col-md-6">
          <span class="infoLabel">Number of Donors: </span>
          <span class="infoValue donorCount"></span>
        </div>
        <div class="infoLine col-md-6">
          <span class="infoLabel">Total Amount Pledged: </span>
          <span class="infoValue amountPledged"></span>
        </div>
      </div>
    </div>
  </div>
  TEST
    
    <script type="text/javascript">
    
      //Initialize feed loader
//      google.load("feeds", "1");
      var gadgetMode = true;

      //Calling initialization routing on gadget loading
      gadgets.util.registerOnLoadHandler(function() { 
        initialize("graphPanel", true);

        gadgets.window.adjustHeight();
        window.history.pushState({}, '', document.URL);
       });
       
       /*
       //Resize listener for gadget resizing on layout changes
       var prevWindowWidth= -1;
       var carousel_aspect_ratio = -1;
       var prevSwitchedWidth = -1;
       $( window ).resize(function() {
            if(prevWindowWidth < 0){
              prevWindowWidth = $(window).width();
              prevSwitchedWidth = prevWindowWidth;
              carousel_aspect_ratio = $("#myCarousel").width() / $("#myCarousel").height()
            }
            else{
              var w = $(window).width();
              var resize_required = (prevWindowWidth >= 768 && w < 768) ||
                          (prevWindowWidth < 768 && w >= 768) ||
                          (prevWindowWidth >= 992 && w < 992) ||
                          (prevWindowWidth < 992 && w >= 992) | 
                          (prevWindowWidth <= w - 5) ||
                          (prevWindowWidth >= w+5);

              if(resize_required){
                gadgets.window.adjustHeight();
                prevSwitchedWidth = w;
              }
              
              if(carousel_aspect_ratio > 0){
                var new_carousel_height = $("#myCarousel").width() / carousel_aspect_ratio;
                $("#myCarousel").height(new_carousel_height)
              }
              
              //gadgets.window.adjustHeight();
              prevWindowWidth = w;            
            }
        }); 
        */

    </script>
     ]]>
  </Content> 
</Module>