<!DOCTYPE html>
<html lang="en-US">
<head>
	<script src="js/jquery.min.js"></script>
	<script src="js/jquery-ui.min.js"></script>
	<link rel="stylesheet" href="audio-player2.css">
</head>
<body>
	<div id="wrapper">
		<section id="listen">
			<p class="player">									  
				<span id="playtoggle"></span>
				<span id="gutter" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all">
					<span id="handle" class="ui-slider-handle"></span>
				</span>
				<span id="timeleft"></span>									  
				<audio preload="metadata" id="myaudio">
					<source src="https://archive.org/download/MBVCASkypeDiscussionRathupamaSuttaFeb102017/MBVCA_Skype%20Discussion_Rathu%CC%84pama_Sutta_Feb%2010_2017.mp3" type="audio/mpeg">
				</audio>
			</p>
		</section>
	</div>

	<script type="text/javascript">

		var audio = $('#myaudio').get(0);
		var loadingIndicator = $('.player #loading');
		var positionIndicator = $('.player #handle');
		var timeleft = $('.player #timeleft');
		var manualSeek = false;
		var loaded = false;

		if ((audio.buffered != undefined) && (audio.buffered.length != 0)) {
		  $(audio).bind('progress', function() {
		     loaded = parseInt(((audio.buffered.end(0) / audio.duration) * 100), 10);
		    loadingIndicator.css({width: loaded + '%'});
		  });
		}
		else {
		  loadingIndicator.remove();
		}	


		$(audio).bind('timeupdate', function() {

		  var rem = parseInt(audio.duration - audio.currentTime, 10),
		  pos = (audio.currentTime / audio.duration) * 100,
		  mins = Math.floor(rem/60,10),
		  secs = rem - mins*60;

		  timeleft.text('-' + mins + ':' + (secs > 9 ? secs : '0' + secs));
		  if (!manualSeek) { positionIndicator.css({left: pos + '%'}); }
		  if (!loaded) {
		    loaded = true;

		    $('.player #gutter').slider({
		      value: 0,
		      step: 0.01,
		      orientation: "horizontal",
		      range: "min",
		      max: audio.duration,
		      animate: true,
		      slide: function() {
		        manualSeek = true;
		      },
		      stop:function(e,ui) {
		        manualSeek = false;
		        audio.currentTime = ui.value;
		      }
		    });
		  }

		});


		$(audio).bind('play',function() {
		  $("#playtoggle").addClass('playing');
		}).bind('pause ended', function() {
		  $("#playtoggle").removeClass('playing');
		});

		$("#playtoggle").click(function() {
		  if (audio.paused) { audio.play(); }
		  else { audio.pause(); }
		});		

	</script>
</body>
</html>